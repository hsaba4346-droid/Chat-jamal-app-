<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: #fff;
    margin: 0;
}
#login, #chat {
    display: none;
    height: 100vh;
}
#login {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
input, button {
    padding: 12px;
    margin: 8px;
    border-radius: 8px;
    border: none;
    font-size: 16px;
}
button {
    background: #25D366;
    color: #000;
    cursor: pointer;
}
#messages {
    height: 80vh;
    overflow-y: auto;
    padding: 10px;
}
.msg {
    margin-bottom: 10px;
    background: #1e1e1e;
    padding: 10px;
    border-radius: 10px;
}
.name {
    color: #25D366;
    font-weight: bold;
}
#sendBox {
    display: flex;
    padding: 10px;
}
#sendBox input {
    flex: 1;
}
</style>
</head>

<body>

<div id="login">
    <h2>ðŸ’¬ Ø¯Ø±Ø¯Ø´Ø© Ø¹Ø§Ù…Ø©</h2>
    <input id="username" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ">
    <button onclick="enterChat()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div id="chat">
    <div id="messages"></div>
    <div id="sendBox">
        <input id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©">
        <button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// ðŸ”¹ Firebase Config (Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ)
const firebaseConfig = {
  apiKey: "AIzaSyCt8LhlTpYzykK8tacEockGq1mM2RlX0g8",
  authDomain: "chat-jamal-app.firebaseapp.com",
  databaseURL: "https://chat-jamal-app-default-rtdb.firebaseio.com",
  projectId: "chat-jamal-app",
  storageBucket: "chat-jamal-app.firebasestorage.app",
  messagingSenderId: "982435518690",
  appId: "1:982435518690:web:51ae3c73dc341b83c826bb"
};

// ðŸ”¹ ØªØ´ØºÙŠÙ„ Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ===============================
// ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©
// ===============================
let user = "";

// Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
document.getElementById("login").style.display = "flex";

// Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø´Ø§Øª
function enterChat() {
    user = document.getElementById("username").value.trim();
    if (!user) {
        alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ");
        return;
    }
    document.getElementById("login").style.display = "none";
    document.getElementById("chat").style.display = "block";
}

// Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
function sendMessage() {
    const text = document.getElementById("messageInput").value.trim();
    if (!text) return;

    db.ref("messages").push({
        name: user,
        text: text,
        time: Date.now()
    });

    document.getElementById("messageInput").value = "";
}

// Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©
db.ref("messages").limitToLast(100).on("child_added", snap => {
    const msg = snap.val();
    const div = document.createElement("div");
    div.className = "msg";
    div.innerHTML = `<div class="name">${msg.name}</div>${msg.text}`;
    document.getElementById("messages").appendChild(div);
    document.getElementById("messages").scrollTop =
        document.getElementById("messages").scrollHeight;
});
</script>

</body>
</html>
